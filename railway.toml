[build]
  builder = "nixpacks"
  buildCommand = "mvn clean package -DskipTests"
  installCommand = ""
  startCommand = "java -Dspring.profiles.active=prod -jar target/*.jar"

[deploy]
  startCommand = "java -Dspring.profiles.active=prod -jar target/*.jar"
  healthcheckPath = "/actuator/health"
  healthcheckTimeout = 100
  restartDelay = 5
  restartMaxRetries = 5
  restartTimeout = 180

[variables]
  SPRING_PROFILES_ACTIVE = "prod"
  JAVA_OPTS = "-Xmx512m -Xms256m"
  PORT = "8080"
  
  # Database configuration
  JDBC_DATABASE_URL = "jdbc:postgresql://shinkansen.proxy.rlwy.net:53264/database-c?sslmode=require"
  DB_USERNAME = "postgres"
  DB_PASSWORD = "LOxSxtZTHciQdGLpPgKKflQfmNlXVFRh"
  
  # HikariCP Configuration
  SPRING_DATASOURCE_HIKARI_CONNECTION_TIMEOUT = "20000"
  SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE = "10"
  SPRING_DATASOURCE_HIKARI_MINIMUM_IDLE = "5"
  SPRING_DATASOURCE_HIKARI_IDLE_TIMEOUT = "30000"
  SPRING_DATASOURCE_HIKARI_MAX_LIFETIME = "2000000"
  SPRING_DATASOURCE_HIKARI_LEAK_DETECTION_THRESHOLD = "5000"
